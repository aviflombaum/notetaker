  $(function(){


    function Note(name, content, referenceName, referenceLink){
      this.name = name;
      this.content = content + referenceName + referenceLink;
      this.referenceName = referenceName;
      this.referenceLink = referenceLink;
      // is this the right way to deal with this relationship?
  }


  Note.prototype.format = function(){
      $('.newNoteName').text(this.name);
      $('.newNoteContent').text(this.content);
      // what is the best way to use erb? this.name should actually be a link to the note
    }

    $('form').submit(function(event){
      event.preventDefault();
      var values = $(this).serialize();
      var posting = $.post('/notes', values);

      posting.done(function(data) {
        note = new Note (data["note"]["name"], data["note"]["content"], data["note"]["reference"]["name"], data["note"]["reference"]["reference_link"]);
        note.format();
        $("form").trigger("reset");
      });
    });



    $('.show').click(function() {
       $('.notebook-details').toggle();
    });

    $('.noteName').click(function() {
       $('.noteContent').toggle();
    });

    $(".panel").hover(function(){
      $(this).addClass("panelHover")
    }, function(){
      $(this).removeClass("panelHover")

    }
  );


// SHOW/HIDE
  $('.all-references-top').on('click', function() {
	   $parent_box = $(this).closest('.all-references');
	   $parent_box.siblings().find('.all-references-bottom').hide();
	   $parent_box.find('.all-references-bottom').toggle();
  });

  $('.my-references-top').on('click', function() {
    $parent_box = $(this).closest('.my-references');
    $parent_box.siblings().find('.my-references-bottom').hide();
    $parent_box.find('.my-references-bottom').toggle();
  });

// More button - notebooks/note
  $(".js-more").on('click', function() {
    var id = $(this).data("id");
    $.get("/notes/" + id + "/note_data", function(data) {
      $("#content-" + id).html(data["content"])
    });

    // $(this).addClass("hidden");
    // $(this).next().removeClass("hidden");
    // debugger;
  });


// not working -- running more function
  $(".js-less").on('click', function() {
    if (content.length > 100) {
      return content.substring(0, 100);
    } else {
      return content;
    }
    var id = $(this).data("id");
    var fullText = $("#content-" + id).text();
    var shortText = fullText.slice(0, 100);

    $(".js-less").addClass( "hidden")
    $(this).prev().removeClass("js-less")
    debugger;
  });

});
