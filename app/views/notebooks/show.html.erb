

  <div class="col-md-10 col-md-offset-1">
    <div class="row notebookSection">
      <h1 class="page-header"><%= @notebook.title %></h1>
      <div class="inline">
        <%= link_to 'Back', notebook_path(@notebook), :class => "btn btn-xs btn-default" %>
        <% if current_user.id == @notebook.user_id %>
          <%= link_to 'New Note', new_notebook_note_path(@notebook, @note), :class => "btn btn-xs btn-default" %>
          <%= link_to "Delete", @notebook, method: :delete, data: {confirm: "Are you sure you want to delete this notebook?"}, :class => "btn btn-xs btn-default" %>
        <% end %>
      </div>
      <p><%= pluralize(@notebook.reference_count, 'reference') %>  in this notebook</p>

    </div>

    <div class="row notebookNoteSection">
      <% @notebook.notes.each do |note|  %>
          <h4 class="noteName"> <%= note.id %>: <%= note.name%></h4>
          <div id="content-<%= note.id %>"> <%=truncate(note.content, length: 100) %></div>
          <button class='js-more btn' data-id='<%= note.id %>'> More...</button>
      <% end %>

    </div>
  </div>




<!--  NOTES FORM -->
  <%= form_for @notebook.notes.build do |f| %>
    <%= f.hidden_field(:notebook_id) %>
    <div class="form-group">
      <%= f.label :reference_link, :class => "control-label" %>
      <%= f.select :reference_id, Reference.all.collect { |r| [r.reference_link, r.id]}, include_blank: :true, :class => "form-control" %>
    </div>


    <div class="form-group">
        <%= f.label :name, :class => "control-label" %>
        <%= f.text_field :name, :class => "form-control", :id => "name" %>
    </div>

    <div class="form-group">
        <%= f.label :content, :class => "control-label" %>
        <%= f.text_area :content, :class => "form-control", :id=> "content" %>
    </div>

    <%= f.submit "Submit", :class => "btn btn-default" %>
  <% end %>


  <script type="text/javascript" charset="UTF-8">
 $(function(){
    $('form').submit(function(event){
      event.preventDefault();
      var values = $(this).serialize();
      var posting = $.post('/notes', values);

      posting.done(function(data) {
        var note = data["note"];
        var newNote = '<h4> Note: ' + note['name'] + '</h4>';
        newNote += '<p>' + note['content'] + '</p>';
        $('.notebookNoteSection').append(newNote);
      });
      $("form").trigger("reset");
    });

  });

</script>
